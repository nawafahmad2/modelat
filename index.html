<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ÙØ³Ø§ØªÙŠÙ†</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script>
        const { useState, useEffect } = React;
        
        // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let productsDB = [];

        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ API
        const sendToAPI = async (products) => {
            try {
                const response = await fetch('/api/send', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        products: products,
                        timestamp: new Date().toISOString()
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­:', data);
                    alert(`âœ… ${data.message}\nØ¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${data.data.productsCount}`);
                } else {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:', data);
                    alert(`âŒ Ø®Ø·Ø£: ${data.message}`);
                }
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„:', error);
                alert(`âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…: ${error.message}`);
            }
        };

        const FashionCatalog = () => {
            const [products, setProducts] = useState(productsDB);
            const [showAddForm, setShowAddForm] = useState(false);
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [editingProduct, setEditingProduct] = useState(null);

            const saveProduct = (product) => {
                let updatedProducts;
                const existingIndex = products.findIndex(p => p.id === product.id);
                
                if (existingIndex >= 0) {
                    updatedProducts = [...products];
                    updatedProducts[existingIndex] = product;
                } else {
                    updatedProducts = [...products, product];
                }
                
                productsDB = updatedProducts;
                setProducts(updatedProducts);
            };

            const deleteProduct = (productId) => {
                if (window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ØŸ')) {
                    const updatedProducts = products.filter(p => p.id !== productId);
                    productsDB = updatedProducts;
                    setProducts(updatedProducts);
                }
            };

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const productId = params.get('product');
                if (productId && products.length > 0) {
                    const product = products.find(p => p.id === productId);
                    if (product) {
                        setSelectedProduct(product);
                    }
                }
            }, [products]);

            return React.createElement('div', {
                className: 'min-h-screen bg-gradient-to-br from-pink-50 to-purple-50',
                style: { direction: 'rtl' }
            }, [
                React.createElement('div', { className: 'bg-white shadow-md', key: 'header' }, 
                    React.createElement('div', { className: 'max-w-7xl mx-auto px-4 py-6' },
                        React.createElement('div', { className: 'flex justify-between items-center flex-wrap gap-4' }, [
                            React.createElement('div', { key: 'title' }, [
                                React.createElement('h1', { className: 'text-3xl font-bold text-gray-800' }, 'ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ÙØ³Ø§ØªÙŠÙ†'),
                                React.createElement('p', { className: 'text-gray-600 mt-1' }, 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª Ø¨Ø³Ù‡ÙˆÙ„Ø©')
                            ]),
                            React.createElement('div', { className: 'flex gap-2 flex-wrap', key: 'buttons' }, [
                                React.createElement('button', {
                                    onClick: () => setShowAddForm(true),
                                    className: 'bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition shadow-lg',
                                    key: 'add-btn'
                                }, 'â• Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¯ÙŠÙ„ Ø¬Ø¯ÙŠØ¯'),
                                React.createElement('button', {
                                    onClick: () => products.length > 0 && sendToAPI(products),
                                    className: `${products.length > 0 ? 'bg-green-600 hover:bg-green-700' : 'bg-gray-400'} text-white px-6 py-3 rounded-lg transition shadow-lg`,
                                    disabled: products.length === 0,
                                    key: 'send-btn'
                                }, `ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (${products.length})`)
                            ])
                        ])
                    )
                ),
                React.createElement('div', { className: 'max-w-7xl mx-auto px-4 py-8', key: 'content' },
                    products.length === 0 ?
                        React.createElement('div', { className: 'text-center py-16' }, [
                            React.createElement('div', { className: 'text-gray-400 mb-4', style: { fontSize: '64px' } }, 'â•'),
                            React.createElement('h3', { className: 'text-xl text-gray-600 mb-2' }, 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ¯ÙŠÙ„Ø§Øª Ø¨Ø¹Ø¯'),
                            React.createElement('p', { className: 'text-gray-500' }, 'Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ù…ÙˆØ¯ÙŠÙ„ Ù„Ùƒ')
                        ]) :
                        React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6' },
                            products.map((product) =>
                                React.createElement(ProductCard, {
                                    key: product.id,
                                    product: product,
                                    onView: () => setSelectedProduct(product),
                                    onEdit: () => setEditingProduct(product),
                                    onDelete: () => deleteProduct(product.id)
                                })
                            )
                        )
                ),
                showAddForm && React.createElement(ProductForm, {
                    key: 'add-form',
                    onSave: (product) => {
                        saveProduct(product);
                        setShowAddForm(false);
                    },
                    onCancel: () => setShowAddForm(false)
                }),
                editingProduct && React.createElement(ProductForm, {
                    key: 'edit-form',
                    product: editingProduct,
                    onSave: (product) => {
                        saveProduct(product);
                        setEditingProduct(null);
                    },
                    onCancel: () => setEditingProduct(null)
                }),
                selectedProduct && React.createElement(ProductView, {
                    key: 'view',
                    product: selectedProduct,
                    onClose: () => setSelectedProduct(null)
                })
            ]);
        };

        const ProductCard = ({ product, onView, onEdit, onDelete }) => {
            return React.createElement('div', {
                className: 'bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition'
            }, [
                React.createElement('div', {
                    className: 'relative bg-gray-100',
                    style: { height: '256px' },
                    key: 'img'
                },
                    React.createElement('img', {
                        src: product.image,
                        alt: product.modelNumber,
                        className: 'w-full h-full object-cover'
                    })
                ),
                React.createElement('div', { className: 'p-4', key: 'details' }, [
                    React.createElement('h3', {
                        className: 'text-xl font-bold text-gray-800 mb-2'
                    }, `Ù…ÙˆØ¯ÙŠÙ„ ${product.modelNumber}`),
                    product.colors && React.createElement('p', {
                        className: 'text-sm text-gray-600 mb-1'
                    }, `Ø§Ù„Ø£Ù„ÙˆØ§Ù†: ${product.colors}`),
                    product.sizes && React.createElement('p', {
                        className: 'text-sm text-gray-600 mb-1'
                    }, `Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª: ${product.sizes}`),
                    product.price && React.createElement('p', {
                        className: 'text-lg font-bold text-green-600 mb-2'
                    }, product.price),
                    product.season && React.createElement('p', {
                        className: 'text-sm text-purple-600 mb-3'
                    }, `ğŸŒ¤ï¸ ${product.season}`),
                    React.createElement('div', { className: 'flex gap-2' }, [
                        React.createElement('button', {
                            onClick: onView,
                            className: 'flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition text-sm'
                        }, 'ğŸ‘ï¸ Ø¹Ø±Ø¶'),
                        React.createElement('button', {
                            onClick: onEdit,
                            className: 'flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition text-sm'
                        }, 'âœï¸ ØªØ¹Ø¯ÙŠÙ„'),
                        React.createElement('button', {
                            onClick: onDelete,
                            className: 'bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition text-sm'
                        }, 'ğŸ—‘ï¸')
                    ])
                ])
            ]);
        };

        const ProductForm = ({ product, onSave, onCancel }) => {
            const [formData, setFormData] = useState(product || {
                id: Date.now().toString(),
                image: '',
                modelNumber: '',
                sizes: '',
                colors: '',
                dozenCount: '',
                price: '',
                season: '',
                description: ''
            });
            const [imagePreview, setImagePreview] = useState(product?.image || '');

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setImagePreview(reader.result);
                        setFormData({ ...formData, image: reader.result });
                    };
                    reader.readAsDataURL(file);
                }
            };

            const handleSubmit = () => {
                if (!formData.image || !formData.modelNumber) {
                    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
                    return;
                }
                onSave(formData);
            };

            return React.createElement('div', {
                className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50',
                style: { overflowY: 'auto' }
            },
                React.createElement('div', { className: 'bg-white rounded-lg shadow-xl max-w-2xl w-full my-8' },
                    React.createElement('div', { className: 'p-6' }, [
                        React.createElement('div', { className: 'flex justify-between items-center mb-6' }, [
                            React.createElement('h2', {
                                className: 'text-2xl font-bold text-gray-800'
                            }, product ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„' : 'Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¯ÙŠÙ„ Ø¬Ø¯ÙŠØ¯'),
                            React.createElement('button', {
                                onClick: onCancel,
                                className: 'text-gray-500 hover:text-gray-700 text-2xl'
                            }, 'âœ•')
                        ]),
                        React.createElement('div', { className: 'space-y-4' }, [
                            FormField('ØµÙˆØ±Ø© Ø§Ù„ÙØ³ØªØ§Ù† *', 'file', formData.image, null, handleImageUpload, imagePreview),
                            FormField('Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ *', 'text', formData.modelNumber, (v) => setFormData({...formData, modelNumber: v}), null, null, 'Ù…Ø«Ø§Ù„: F001'),
                            FormField('Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©', 'text', formData.sizes, (v) => setFormData({...formData, sizes: v}), null, null, 'Ù…Ø«Ø§Ù„: 38, 40, 42, 44'),
                            FormField('Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªÙˆÙØ±Ø©', 'text', formData.colors, (v) => setFormData({...formData, colors: v}), null, null, 'Ù…Ø«Ø§Ù„: Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠØŒ Ø£Ø­Ù…Ø±ØŒ Ø£Ø²Ø±Ù‚'),
                            FormField('Ø§Ù„Ø¹Ø¯Ø¯ ÙÙŠ Ø§Ù„Ø¯Ø±Ø²Ù†', 'text', formData.dozenCount, (v) => setFormData({...formData, dozenCount: v}), null, null, 'Ù…Ø«Ø§Ù„: 12 Ù‚Ø·Ø¹Ø©'),
                            FormField('Ø§Ù„Ø³Ø¹Ø±', 'text', formData.price, (v) => setFormData({...formData, price: v}), null, null, 'Ù…Ø«Ø§Ù„: 50,000 Ø¯ÙŠÙ†Ø§Ø±'),
                            FormField('Ø§Ù„Ù…ÙˆØ³Ù…', 'select', formData.season, (v) => setFormData({...formData, season: v})),
                            FormField('ÙˆØµÙ Ø¥Ø¶Ø§ÙÙŠ', 'textarea', formData.description, (v) => setFormData({...formData, description: v}), null, null, 'Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©...')
                        ]),
                        React.createElement('div', { className: 'flex gap-3 pt-4' }, [
                            React.createElement('button', {
                                onClick: handleSubmit,
                                className: 'flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition'
                            }, 'ğŸ’¾ Ø­ÙØ¸'),
                            React.createElement('button', {
                                onClick: onCancel,
                                className: 'flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition'
                            }, 'Ø¥Ù„ØºØ§Ø¡')
                        ])
                    ])
                )
            );
        };

        const FormField = (label, type, value, onChange, onFileChange, preview, placeholder) => {
            return React.createElement('div', {}, [
                React.createElement('label', {
                    className: 'block text-sm font-medium text-gray-700 mb-2'
                }, label),
                type === 'file' ? [
                    React.createElement('input', {
                        type: 'file',
                        accept: 'image/*',
                        onChange: onFileChange,
                        className: 'w-full p-2 border border-gray-300 rounded-lg',
                        key: 'input'
                    }),
                    preview && React.createElement('img', {
                        src: preview,
                        alt: 'Ù…Ø¹Ø§ÙŠÙ†Ø©',
                        className: 'mt-2 rounded-lg',
                        style: { height: '160px', objectFit: 'contain' },
                        key: 'preview'
                    })
                ] : type === 'textarea' ? 
                    React.createElement('textarea', {
                        value: value,
                        onChange: (e) => onChange(e.target.value),
                        className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500',
                        rows: 3,
                        placeholder: placeholder
                    }) : type === 'select' ?
                    React.createElement('select', {
                        value: value,
                        onChange: (e) => onChange(e.target.value),
                        className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500'
                    }, [
                        React.createElement('option', { value: '' }, 'Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ³Ù…'),
                        React.createElement('option', { value: 'ØµÙŠÙÙŠ' }, 'ØµÙŠÙÙŠ'),
                        React.createElement('option', { value: 'Ø´ØªÙˆÙŠ' }, 'Ø´ØªÙˆÙŠ'),
                        React.createElement('option', { value: 'Ø±Ø¨ÙŠØ¹ÙŠ' }, 'Ø±Ø¨ÙŠØ¹ÙŠ'),
                        React.createElement('option', { value: 'Ø®Ø±ÙŠÙÙŠ' }, 'Ø®Ø±ÙŠÙÙŠ'),
                        React.createElement('option', { value: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù…' }, 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù…')
                    ]) :
                    React.createElement('input', {
                        type: type,
                        value: value,
                        onChange: (e) => onChange(e.target.value),
                        className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500',
                        placeholder: placeholder
                    })
            ]);
        };

        const ProductView = ({ product, onClose }) => {
            const productUrl = `${window.location.origin}${window.location.pathname}?product=${product.id}`;

            return React.createElement('div', {
                className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50',
                style: { overflowY: 'auto' }
            },
                React.createElement('div', { className: 'bg-white rounded-lg shadow-xl max-w-4xl w-full my-8' },
                    React.createElement('div', { className: 'p-6' }, [
                        React.createElement('div', { className: 'flex justify-between items-center mb-6' }, [
                            React.createElement('h2', {
                                className: 'text-2xl font-bold text-gray-800'
                            }, `Ù…ÙˆØ¯ÙŠÙ„ ${product.modelNumber}`),
                            React.createElement('button', {
                                onClick: onClose,
                                className: 'text-gray-500 hover:text-gray-700 text-2xl'
                            }, 'âœ•')
                        ]),
                        React.createElement('div', { className: 'grid md:grid-cols-2 gap-6' }, [
                            React.createElement('div', {},
                                React.createElement('img', {
                                    src: product.image,
                                    alt: product.modelNumber,
                                    className: 'w-full h-auto rounded-lg shadow-lg'
                                })
                            ),
                            React.createElement('div', { className: 'space-y-4' }, [
                                DetailBox('Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„', product.modelNumber),
                                product.sizes && DetailBox('Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©', product.sizes),
                                product.colors && DetailBox('Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªÙˆÙØ±Ø©', product.colors),
                                product.dozenCount && DetailBox('Ø§Ù„Ø¹Ø¯Ø¯ ÙÙŠ Ø§Ù„Ø¯Ø±Ø²Ù†', product.dozenCount),
                                product.price && DetailBox('ğŸ’° Ø§Ù„Ø³Ø¹Ø±', product.price, 'green'),
                                product.season && DetailBox('ğŸŒ¤ï¸ Ø§Ù„Ù…ÙˆØ³Ù…', product.season, 'purple'),
                                product.description && DetailBox('ÙˆØµÙ Ø¥Ø¶Ø§ÙÙŠ', product.description),
                                React.createElement('div', { className: 'bg-blue-50 p-4 rounded-lg border-2 border-blue-200' }, [
                                    React.createElement('h3', { className: 'font-bold text-lg mb-2' }, 'ğŸ“± Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬'),
                                    React.createElement('p', { className: 'text-sm text-gray-600 mb-2', style: { wordBreak: 'break-all' } }, productUrl),
                                    React.createElement('a', {
                                        href: `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(productUrl)}`,
                                        download: `QR_${product.modelNumber}.png`,
                                        className: 'inline-block bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm'
                                    }, 'ØªØ­Ù…ÙŠÙ„ QR Code')
                                ])
                            ])
                        ])
                    ])
                )
            );
        };

        const DetailBox = (title, value, color) => {
            const bgColor = color === 'green' ? 'bg-green-50 border-2 border-green-200' : 
                           color === 'purple' ? 'bg-purple-50' : 'bg-gray-50';
            return React.createElement('div', { className: `${bgColor} p-4 rounded-lg` }, [
                React.createElement('h3', { className: 'font-bold text-lg mb-2' }, title),
                React.createElement('p', { className: color === 'green' ? 'text-gray-700 text-xl' : 'text-gray-700' }, value)
            ]);
        };

        ReactDOM.render(
            React.createElement(FashionCatalog),
            document.getElementById('root')
        );
    </script>
</body>
</html>